!function(t){t.fn.zdDatePater=function(t){var i=new e(this,t);return i.init(this),i},t.fn.zdDatePater.defaultOptions={beginYear:1900,endYear:2050,timeOf:!1};var e=function(e,i){this.options=t.extend(!0,{},t.fn.zdDatePater.defaultOptions,i)},i=1,a=1,l=1,r=1,n=1,d=null,s=null,o=null,u=null,c=null,p=0,f=0;e.prototype={init:function(t){this.dgDate(t)},dgDate:function(e){function d(){if(""===e.val()){var d=new Date;i=d.getFullYear()-parseInt(o.options.beginYear)+1,a=d.getMonth()+1,l=d.getDate(),o.options.timeOf&&(r=d.getHours()+1,n=d.getMinutes()+1)}else i=parseInt(e.val().substr(0,4))-o.options.beginYear+1,a=parseInt(e.val().substr(5,2)),l=parseInt(e.val().substr(8,2)),o.options.timeOf&&(r=parseInt(e.val().substr(11,2))+1,n=parseInt(e.val().substr(14,2))+1);o.monthLastDay(i,a),p=s.find(".dg_date_ul").height()/3,o.refreshDate(s),o.options.timeOf&&o.refreshTime(),s.find(".dg_date_sure").click(function(){var d=s.find("#dateYearWrapper li").eq(Math.ceil(i)).text().substr(0,4);d+="-"+s.find("#dateMonthWrapper li").eq(Math.ceil(a)).text().substr(0,2),d+="-"+s.find("#dateDayWrapper li").eq(Math.ceil(l)).text().substr(0,2),o.options.timeOf&&(d+=" "+s.find("#dateHourWrapper li").eq(Math.ceil(r)).text().substr(0,2),d+=":"+s.find("#dateMinuteWrapper li").eq(Math.ceil(n)).text().substr(0,2)),e.val(d),t("#dg_date").remove()}),s.find(".dg_date_empty").click(function(){e.val("")}),s.find(".dg_date_cancel").click(function(){t("#dg_date").remove()})}var s=t('<div class="dg_date" id="dg_date"><div class="dg_data_bg"></div><div class="dg_date_body"><div class="dg_date_title">选择日期</div><div class="dg_date_scroll"><div class="dg_date_bg"></div><div class="dg_date_ul" id="dateYearWrapper"><ul></ul></div><div class="dg_date_ul" id="dateMonthWrapper"><ul></ul></div><div class="dg_date_ul" id="dateDayWrapper"><ul></ul></div></div></div></div>');this.options.timeOf&&(s.find(".dg_date_body").addClass("dg_time_body").append('  <div class="dg_date_scroll"><div class="dg_date_bg"></div><div class="dg_time_ul" id="dateHourWrapper"><ul></ul></div><div class="dg_time_ul" id="dateMinuteWrapper"><ul></ul></div></div>'),this.createTime(s)),s.find(".dg_date_body").append('<div class="dg_date_btn"><a class="dg_date_sure" href="javascript:void(0);">确定</a><a class="dg_date_empty" href="javascript:void(0);">清除</a><a class="dg_date_cancel" href="javascript:void(0);">取消</a></div>'),this.createDate(s);var o=this;e.click(function(){t("body").append(s),d()})},refreshDate:function(t){this.day_scroll(t),d.refresh(),s.refresh(),o.refresh(),d.scrollTo(0,(i-1)*p,0,!0),s.scrollTo(0,(a-1)*p,0,!0),o.scrollTo(0,(l-1)*p,0,!0)},day_scroll:function(t){var e=this;d=new iScroll("dateYearWrapper",{snap:"li",vScrollbar:!1,onScrollEnd:function(){i=this.y/p*-1+1,e.monthLastDay(i,a),t.find("#dateDayWrapper ul").html(e.ulDay()),o.refresh()}}),s=new iScroll("dateMonthWrapper",{snap:"li",vScrollbar:!1,onScrollEnd:function(){a=this.y/p*-1+1,e.monthLastDay(i,a),t.find("#dateDayWrapper ul").html(e.ulDay()),o.refresh()}}),o=new iScroll("dateDayWrapper",{snap:"li",vScrollbar:!1,onScrollEnd:function(){l=this.y/p*-1+1}})},refreshTime:function(){this.time_scroll(),u.refresh(),c.refresh(),u.scrollTo(0,(r-1)*p,0,!0),c.scrollTo(0,(n-1)*p,0,!0)},time_scroll:function(){u=new iScroll("dateHourWrapper",{snap:"li",vScrollbar:!1,onScrollEnd:function(){r=this.y/p*-1+1}}),c=new iScroll("dateMinuteWrapper",{snap:"li",vScrollbar:!1,onScrollEnd:function(){n=this.y/p*-1+1}})},createDate:function(t){t.find("#dateYearWrapper ul").html(this.ulYear()),t.find("#dateMonthWrapper ul").html(this.ulMonth()),t.find("#dateDayWrapper ul").html(this.ulDay())},createTime:function(t){t.find("#dateHourWrapper ul").html(this.ulHour()),t.find("#dateMinuteWrapper ul").html(this.ulMinute())},ulYear:function(){for(var t="<li>&nbsp;</li>",e=this.options.beginYear;e<=this.options.endYear;e++)t+="<li>"+e+"年</li>";return t+"<li>&nbsp;</li>"},ulMonth:function(){for(var t="<li>&nbsp;</li>",e=1;12>=e;e++)t+="<li>"+(10>e?"0":"")+e+"月</li>";return t+"<li>&nbsp;</li>"},ulDay:function(){for(var t="<li>&nbsp;</li>",e=1;f>=e;e++)t+="<li>"+(10>e?"0":"")+e+"日</li>";return t+"<li>&nbsp;</li>"},ulHour:function(){for(var t="<li>&nbsp;</li>",e=0;23>=e;e++)t+="<li>"+(10>e?"0":"")+e+"时</li>";return t+"<li>&nbsp;</li>"},ulMinute:function(){for(var t="<li>&nbsp;</li>",e=0;59>=e;e++)t+="<li>"+(10>e?"0":"")+e+"分</li>";return t+"<li>&nbsp;</li>"},monthLastDay:function(t,e){var i=new Date(this.options.beginYear+t-1,e,0);f=i.getDate()}}}(jQuery);